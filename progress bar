# List of extensions to lock
$extensions = @(
    "ext1",
    "ext2",
    "ext3",
    "ext4"
)

$total = $extensions.Count
$count = 0

foreach ($ext in $extensions) {
    $count++
    $percent = [math]::Round(($count / $total) * 100)

    # Show progress bar
    Write-Progress -Activity "Locking Jupyter Lab Extensions" `
                   -Status "Locking $ext ($count of $total)" `
                   -PercentComplete $percent

    # Run the command
    jupyter labextension lock $ext

    # Optional: check for errors
    if ($LASTEXITCODE -ne 0) {
        Write-Warning "Failed to lock $ext"
    }
}

Write-Host "All extensions processed."